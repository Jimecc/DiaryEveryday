{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport FilesManagement from \"@/components/FilesManagement.vue\";\nexport default {\n  name: \"NewDiaryView\",\n  props: {\n    diary_id: String\n  },\n  components: {\n    FilesManagement\n  },\n  data() {\n    return {\n      articleForm: {\n        id: 0,\n        manager_id: 0,\n        title: '',\n        create_date: new Date(),\n        article: '',\n        info: '',\n        color: '',\n        weather: '',\n        score: 0,\n        collection: 0,\n        shit: 0\n      },\n      fileForm: {\n        id: 0,\n        url: '',\n        name: '',\n        rname: '',\n        info: '',\n        user_id: 0,\n        diary_id: 0,\n        create_date: null\n      },\n      icons: {\n        collection: 'el-icon-star-off',\n        date: 'el-icon-date',\n        shit: 'el-icon-help',\n        weather: 'el-icon-cloudy-and-sunny'\n      },\n      istyle: {\n        collection: 'margin-left: 10px;width:50px;height:50px',\n        date: 'margin-left:0px',\n        shit: '',\n        weather: '',\n        colors: {\n          oragne: 'background-color: coral',\n          green: 'background-color: greenyellow',\n          purple: 'background-color: violet',\n          gray: 'background-color: gray',\n          yellow: 'background-color: yellow',\n          pure: 'background-color: #fff'\n        }\n      },\n      show: {\n        show_pic_div: false,\n        dialogViewImg: true,\n        dialogFormVisible: false\n      },\n      value1: null,\n      value2: null,\n      value3: new Date(),\n      show_date: false,\n      show_weather: false,\n      drawer: true,\n      article: '',\n      images: []\n    };\n  },\n  mounted() {\n    // this.mounted_edit_diary();\n  },\n  methods: {\n    click_view___img() {\n      this.show.dialogViewImg = !this.show.dialogViewImg;\n    },\n    click_delete_img(id) {\n      this.deleteRequest('/file/delete/' + id);\n      this.getRequest('/file/list4article/' + this.articleForm.id).then(resp => {\n        this.images = resp;\n      });\n    },\n    click_show_images() {\n      this.show.show_pic_div = !this.show.show_pic_div;\n      this.getRequest('/file/list4article/' + this.articleForm.id).then(resp => {\n        this.images = resp;\n      });\n    },\n    beforeUploadHandle() {\n      // alert(\"xxx\")\n    },\n    handleUploadForm(param) {\n      // -- 跳出选择框\n      if (this.articleForm.id == 0) {\n        this.$confirm('检测到该日记还没有保存，该操作必须要至少保存一次日记后才可以使用，是否保存？', '提示', {\n          confirmButtonText: '是，立即保存',\n          cancelButtonText: '否，稍后手动保存',\n          type: 'warning'\n        }).then(() => {\n          // -- 如果选择是，那么就进行提交，并且依据status进行判断，将返回值赋给 articleForm，以获得id\n          if (this.articleForm.title == '' || this.articleForm.article == '') {\n            this.$message.error('字段不完整，请填写标题与文章后再提交');\n            return;\n          }\n          this.postRequest('/diary/insert', this.articleForm).then(resp => {\n            if (resp) {\n              if (resp.code == 200) {\n                // -- 提交文章\n                this.articleForm = resp.obj;\n                // -- 上传图片\n                let formData = new FormData();\n                formData.append('file', param.file);\n                formData.append('diary_id', this.articleForm.id);\n                // 向后端发送数据\n                this.postRequest('/file/upload', formData).then(res => {\n                  if (res.code === 200) {\n                    this.$message.success('修改信息成功');\n                  } else {\n                    this.$message.error('修改信息失败');\n                  }\n                  this.formFileList = [];\n                  this.uploadFormFileList = [];\n                });\n              }\n            }\n          });\n          return;\n          // -- 如果选择否，则什么都不做\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消提交'\n          });\n          return;\n        });\n      } else {\n        let formData = new FormData();\n        formData.append('file', param.file);\n        formData.append('diary_id', this.articleForm.id);\n        this.postRequest('/file/upload', formData).then(res => {\n          if (res.code === 200) {\n            this.$message.success('提交成功');\n          } else {\n            this.$message.error('提交失败');\n          }\n          this.formFileList = [];\n          this.uploadFormFileList = [];\n        });\n      }\n    },\n    click_out_without_save() {\n      this.$confirm('检测到未保存的内容，是否在离开页面前保存修改？', '确认信息', {\n        distinguishCancelAndClose: true,\n        confirmButtonText: '保存',\n        cancelButtonText: '放弃修改'\n      }).then(() => {\n        this.$message({\n          type: 'info',\n          message: '保存修改'\n        });\n        this.$store.commit('show_editor_page_false');\n      }).catch(action => {\n        this.$message({\n          type: 'info',\n          message: action === 'cancel' ? '放弃保存并离开页面' : '停留在当前页面'\n        });\n        this.$store.commit('show_editor_page_false');\n      });\n    },\n    click_show_pic_button() {\n      this.show.show_pic_div = !this.show.show_pic_div;\n    },\n    mounted_edit_diary() {\n      if (this.diary_id != '') {\n        this.getRequest('/diary/article/' + this.$route.query.did).then(resp => {\n          if (resp) {\n            // alert(JSON.stringify(resp.data.obj));\n            this.articleForm = resp.data.obj;\n          }\n        });\n      }\n    },\n    // 点击了日期按钮\n    click_show_date() {\n      if (this.show_date == true) {\n        this.show_date = false;\n        this.icons.date = 'el-icon-date';\n        this.istyle.date = 'margin-left:0px';\n      } else {\n        this.icons.date = 'el-icon-loading';\n        this.istyle.date = 'margin-left:0px;background-color:#cfe6ff;border:#409EFF 1px solid;color:#ff7f50';\n        this.show_date = true;\n      }\n    },\n    // 点击了天气按钮\n    click_show_weather() {\n      if (this.show_weather == true) {\n        this.show_weather = false;\n        this.icons.weather = 'el-icon-cloudy-and-sunny';\n        this.istyle.weather = '';\n      } else {\n        this.show_weather = true;\n        this.icons.weather = 'el-icon-sunny';\n        this.istyle.weather = 'background-color:#cfe6ff;border:#409EFF 1px solid;color:#ff7f50';\n      }\n    },\n    // 点击了收藏按钮\n    click_collect() {\n      this.articleForm.shit = 0;\n      this.istyle.shit = '';\n      if (this.articleForm.collection == 1) {\n        this.articleForm.collection = 0;\n        this.icons.collection = 'el-icon-star-off';\n        this.istyle.collection = '';\n      } else {\n        this.articleForm.collection = 1;\n        this.icons.collection = 'el-icon-star-on';\n        this.istyle.collection = 'background-color:#cfe6ff;border:#409EFF 1px solid;color:#ff7f50';\n      }\n    },\n    click_shit() {\n      this.articleForm.collection = 0;\n      this.istyle.collection = '';\n      this.icons.collection = 'el-icon-star-off';\n      if (this.articleForm.shit == 1) {\n        this.articleForm.shit = 0;\n        this.istyle.shit = '';\n      } else {\n        this.articleForm.shit = 1;\n        this.istyle.shit = 'background-color:#cfe6ff;border:#409EFF 1px solid;color:#ff7f50';\n      }\n    },\n    // 功能按钮\n    goBack() {\n      this.$router.push('/');\n    },\n    click_submit() {\n      this.postRequest('/diary/insert', this.articleForm).then(resp => {\n        alert(JSON.stringify(resp.obj));\n        if (resp) {\n          if (resp.code == 200) {\n            this.articleForm = resp.obj;\n          }\n        }\n      });\n    },\n    color_orange() {\n      this.init_color();\n      this.istyle.colors.oragne = 'background-color: coral; box-shadow: 0 0 8px red;';\n      this.articleForm.color = 'coral';\n    },\n    color_green() {\n      this.init_color();\n      this.istyle.colors.green = 'background-color: greenyellow;box-shadow: 0 0 8px green;';\n      this.articleForm.color = 'greenyellow';\n    },\n    color_purple() {\n      this.init_color();\n      this.istyle.colors.purple = 'background-color: violet;box-shadow: 0 0 8px purple;';\n      this.articleForm.color = 'violet';\n    },\n    color_gray() {\n      this.init_color();\n      this.istyle.colors.gray = 'background-color: gray;   box-shadow: 0 0 8px gray;';\n      this.articleForm.color = 'gray';\n    },\n    color_yellow() {\n      this.init_color();\n      this.istyle.colors.yellow = 'background-color: yellow;box-shadow: 0 0 8px gray;';\n      this.articleForm.color = 'yellow';\n    },\n    color_pure() {\n      this.init_color();\n      this.articleForm.color = '';\n    },\n    init_color() {\n      this.istyle.colors.oragne = 'background-color: coral';\n      this.istyle.colors.green = 'background-color: greenyellow';\n      this.istyle.colors.purple = 'background-color: violet';\n      this.istyle.colors.gray = 'background-color: gray';\n      this.istyle.colors.yellow = 'background-color: yellow';\n      this.istyle.colors.pure = 'background-color: #fff';\n    },\n    click_weather(weather) {\n      this.articleForm.weather = weather;\n    }\n  }\n};","map":{"version":3,"mappings":";AAqMA;AACA;EACAA;EACAC;IACAC;EACA;EACAC;IACAC;EACA;EACAC;IACA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;QACAX;QACAY;QACAnB;QACAoB;QACAR;QACAS;QACAnB;QACAQ;MACA;MACAY;QACAN;QACAO;QACAN;QACAH;MACA;MACAU;QACAR;QACAO;QACAN;QACAH;QACAW;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;QACA;MACA;MACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACA9B;MACA+B;IACA;EACA;EACAC;IACA;EAAA,CACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;MACA;QACA;MACA;IACA;IACAC;MACA;MACA;QACA;MACA;IACA;IACAC;MACA;IAAA,CACA;IACAC;MACA;MACA;QACA;UACAC;UACAC;UACAC;QACA;UACA;UACA;YACA;YACA;UACA;UACA;YACA;cACA;gBACA;gBACA;gBACA;gBACA;gBACAC;gBACAA;gBACA;gBACA;kBACA;oBACA;kBACA;oBACA;kBACA;kBACA;kBACA;gBACA;cACA;YACA;UACA;UACA;UACA;QACA;UACA;YACAD;YACAE;UACA;UACA;QACA;MACA;QACA;QACAD;QACAA;QACA;UACA;YACA;UACA;YACA;UACA;UACA;UACA;QACA;MACA;IACA;IACAE;MACA;QACAC;QACAN;QACAC;MACA,GACAM;QACA;UACAL;UACAE;QACA;QACA;MACA,GAEAI;QACA;UACAN;UACAE,+BACA,cACA;QACA;QACA;MACA;IAEA;IACAK;MACA;IACA;IACAC;MACA;QACA;UACA;YACA;YACA;UACA;QACA;MACA;IACA;IACA;IACAC;MACA;QACA;QACA;QACA;MACA;QACA;QACA;QACA;MACA;IACA;IACA;IACAC;MACA;QACA;QACA;QACA;MACA;QACA;QACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;QACA;QACA;QACA;MACA;QACA;QACA;QACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;QACA;QACA;MACA;QACA;QACA;MACA;IACA;IACA;IACAC;MACA;IACA;IACAC;MACA;QACAC;QACA;UACA;YACA;UACA;QACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;IACA;EACA;AACA","names":["name","props","diary_id","components","FilesManagement","data","articleForm","id","manager_id","title","create_date","article","info","color","weather","score","collection","shit","fileForm","url","rname","user_id","icons","date","istyle","colors","oragne","green","purple","gray","yellow","pure","show","show_pic_div","dialogViewImg","dialogFormVisible","value1","value2","value3","show_date","show_weather","drawer","images","mounted","methods","click_view___img","click_delete_img","click_show_images","beforeUploadHandle","handleUploadForm","confirmButtonText","cancelButtonText","type","formData","message","click_out_without_save","distinguishCancelAndClose","then","catch","click_show_pic_button","mounted_edit_diary","click_show_date","click_show_weather","click_collect","click_shit","goBack","click_submit","alert","color_orange","color_green","color_purple","color_gray","color_yellow","color_pure","init_color","click_weather"],"sourceRoot":"src/views","sources":["NewDiaryView.vue"],"sourcesContent":["<template>\n  <div class=\"div_1\">\n    <el-container>\n      <el-header>\n        <el-page-header style=\"margin-top: 25px\" content=\"编辑日记\" @back=\"goBack\"></el-page-header>\n      </el-header>\n      <el-divider>每日一记</el-divider>\n      <el-container>\n        <el-aside class=\"aside_1\">\n          <el-input v-model=\"articleForm.title\" class=\"input_title\" placeholder=\"请输入文章标题\"></el-input>\n          <div style=\"margin-top: 15px;\">\n            <el-tooltip content=\"选择日期(默认今天)\" placement=\"bottom\" effect=\"light\">\n              <el-button @click=\"click_show_date\" :style=\"istyle.date\" class=\"button_4\" size=\"small\" :icon=\"icons.date\"></el-button>\n            </el-tooltip>\n            <el-tooltip content=\"天气\" placement=\"bottom\" effect=\"light\">\n              <el-button @click=\"click_show_weather\" :style=\"istyle.weather\" class=\"button_4\" size=\"small\"  :icon=\"icons.weather\"></el-button>\n            </el-tooltip>\n            <el-tooltip content=\"今天心情太好啦！收藏一下吧！\" placement=\"bottom\" effect=\"light\">\n              <el-button @click=\"click_collect\" :style=\"istyle.collection\" class=\"button_4\" size=\"small\" :icon=\"icons.collection\"></el-button>\n            </el-tooltip>\n            <el-tooltip content=\"今天心情不太行...放到厕所当厕纸吧（沉底）\" placement=\"bottom\" effect=\"light\">\n              <el-button @click=\"click_shit\" :style=\"istyle.shit\" class=\"button_4\" size=\"small\" icon=\"el-icon-toilet-paper\"></el-button>\n            </el-tooltip>\n          </div>\n\n          <!--天气-->\n          <div v-if=\"show_weather\" class=\"div_weather\">\n            <el-tooltip content=\"晴天\" placement=\"top\" effect=\"light\">\n              <el-button @click=\"click_weather('sunny')\" plain type=\"primary\" class=\"button_weather\" icon=\"el-icon-sunny\"></el-button>\n            </el-tooltip>\n            <el-tooltip content=\"多云\" placement=\"top\" effect=\"light\">\n              <el-button @click=\"click_weather('cloudy')\" plain type=\"primary\" class=\"button_weather\" icon=\"el-icon-cloudy\"></el-button>\n            </el-tooltip>\n            <el-tooltip content=\"多云转晴\" placement=\"top\" effect=\"light\">\n              <el-button @click=\"click_weather('cloudy_sunny')\" plain type=\"primary\" class=\"button_weather\" icon=\"el-icon-cloudy-and-sunny\"></el-button>\n            </el-tooltip>\n            <el-tooltip content=\"下雨啦\" placement=\"top\" effect=\"light\">\n              <el-button @click=\"click_weather('rain')\" plain type=\"primary\" class=\"button_weather\" icon=\"el-icon-heavy-rain\"></el-button>\n            </el-tooltip>\n            <el-tooltip content=\"打雷啦\" placement=\"top\" effect=\"light\">\n              <el-button @click=\"click_weather('light')\" plain type=\"primary\" class=\"button_weather\" icon=\"el-icon-lightning\"></el-button>\n            </el-tooltip>\n            <el-tooltip content=\"下雪啦\" placement=\"top\" effect=\"light\">\n              <el-button @click=\"click_weather('snow')\" plain type=\"primary\" class=\"button_weather\" icon=\"el-icon-light-rain\"></el-button>\n            </el-tooltip>\n          </div>\n          <div style=\"margin-top: 15px\">\n            <el-button size=\"small\" @click=\"color_orange\" :style=\"istyle.colors.oragne\" class=\"button_color\"></el-button>\n            <el-button size=\"small\" @click=\"color_green\"  :style=\"istyle.colors.green\"  class=\"button_color\"></el-button>\n            <el-button size=\"small\" @click=\"color_purple\" :style=\"istyle.colors.purple\" class=\"button_color\"></el-button>\n            <el-button size=\"small\" @click=\"color_gray\"   :style=\"istyle.colors.gray\"   class=\"button_color\"></el-button>\n            <el-button size=\"small\" @click=\"color_yellow\" :style=\"istyle.colors.yellow\" class=\"button_color\"></el-button>\n            <el-button size=\"small\" @click=\"color_pure\" :style=\"istyle.colors.pure\"   class=\"button_color\"></el-button>\n          </div>\n          <el-divider content-position=\"left\">给今天打个分吧</el-divider>\n          <div class=\"block\">\n            <el-rate\n                v-model=\"articleForm.score\">\n            </el-rate>\n          </div>\n          <el-divider></el-divider>\n          <div v-if=\"show_date\">\n            <el-date-picker\n                v-model=\"articleForm.create_date\"\n                type=\"date\"\n                placeholder=\"选择日期\">\n            </el-date-picker>\n            <el-divider></el-divider>\n          </div>\n          <div>\n            <el-button @click=\"click_submit\" type=\"primary\" class=\"button-submit\">提交</el-button>\n            <div style=\"display: flex;margin-top: 10px\">\n              <el-button @click=\"click_out_without_save\" type=\"danger\" plain class=\"button-submit-nosave\">不保存退出</el-button>\n              <el-button @click=\"click_out_and_save\" type=\"info\" plain class=\"button-submit-save\">保存并退出</el-button>\n            </div>\n          </div>\n        </el-aside>\n        <el-divider direction=\"vertical\"></el-divider>\n        <el-main>\n          <div style=\"width: 100%;display: flex\">\n            <div style=\"width: 80%\">\n              <el-button size=\"small\" type=\"text\" icon=\"el-icon-picture-outline\">插入图片</el-button>\n              <el-upload\n                  :http-request=\"handleUploadForm\"\n                  :before-upload=\"beforeUploadHandle\"\n                  class=\"upload-demo\"\n                  multiple\n                  :limit=\"10\">\n                <el-button size=\"small\" type=\"text\" icon=\"el-icon-folder-opened\">上传照片</el-button>\n              </el-upload>\n<!--              <el-drawer-->\n<!--                  title=\"附件管理\"-->\n<!--                  style=\"display: flex\"-->\n<!--                  size=\"70%\"-->\n<!--                  :visible.sync=\"drawer\"-->\n<!--                  :with-header=\"true\">-->\n<!--              </el-drawer>-->\n            </div>\n            <div style=\"text-align: right;width: 18%\">\n              <el-button size=\"small\"  @click=\"click_show_images\" type=\"text\" icon=\"el-icon-picture-outline\" >显示相册</el-button>\n            </div>\n          </div>\n          <div style=\"display: flex\">\n            <el-input\n                type=\"textarea\"\n                :autosize=\"{minRows:34,maxRows:35}\"\n                placeholder=\"请输入内容\"\n                v-model=\"articleForm.article\"\n                show-word-limit=\"true\"\n                clearable=\"true\"\n                suffix-icon=\"el-icon-tickets\"\n            >\n            </el-input>\n<!--            &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->\n            <div v-if=\"show.show_pic_div\" style=\"height: 730px;\" class=\"new-diary-div-pics\">\n              <div style=\"display: flow;width:40px\">\n              <el-row>\n                <el-col  :span=\"32\" v-for=\"(img, index) in images\" :key=\"index\" :offset=\"index > 0 ? 2 : 0\">\n                  <div :body-style=\"{ padding: '0px' }\" style=\"width: 220px;height:auto;padding:10px;margin: 20px 30px 20px 30px;border: grey .1px solid;border-radius:15px;box-shadow: 0 0 5px #f3f4f6\">\n                    <img style=\"width:220px;height: auto;left:0;right:0;margin:auto;box-shadow: 0 0 5px #ffebcd\" :src=\"img.url\" class=\"drawer-s-images\">\n                    <div style=\"padding: 14px;\">\n                      <span>{{ img.rname==null ? img.name : img.rname }}</span>\n                      <div>\n                        <time class=\"time\">{{ img.create_date }}</time>\n                      </div>\n                      <div class=\"div-img-button-edit\">\n                        <el-button type=\"text\" icon=\"el-icon-edit\"   class=\"button-img-edit\" @click=\"show.dialogFormVisible = true\"></el-button>\n                        <el-button type=\"text\" icon=\"el-icon-view\"   @click=\"click_view___img\" class=\"button-img-edit\"></el-button>\n                        <el-button type=\"text\" icon=\"el-icon-delete\" @click=\"click_delete_img(img.id)\" class=\"button-img-edit\"></el-button>\n\n                      </div>\n                    </div>\n                  </div>\n                </el-col>\n              </el-row>\n              </div>\n            </div>\n          </div>\n        </el-main>\n      </el-container>\n    </el-container>\n\n    <el-dialog title=\"编辑图片信息\" :visible.sync=\"show.dialogFormVisible\">\n      <el-form :model=\"fileForm\">\n        <el-form-item label=\"图片名称\" label-width=\"80px\">\n          <el-input v-model=\"fileForm.name\" placeholder=\"请输入图片名称\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"图片简介\" label-width=\"80px\">\n          <el-input placeholder=\"请输入简介信息\" type=\"textarea\" size=\"min\" :autosize=\"{ minRows: 4, maxRows: 5}\"v-model=\"fileForm.name\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"show.dialogFormVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"show.dialogFormVisible = false\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog title=\"查看图片\" :visible.sync=\"show.dialogViewImg\">\n        <div style=\"display: flex;width:100%;\">\n<!--            <img style=\"border: #999999 0.1px solid;padding:10px;width: 70%;height: auto\" src=\"http://192.168.199.100:8888/group1/M00/00/01/wKjHZGPr1ZWAYs28AAGrxVybNPY401.JPG\"/>-->\n<!--            <img style=\"border: #999999 0.1px solid;padding:10px;width: 70%;height: auto\" src=\"http://192.168.199.100:8888/group1/M00/00/01/wKjHZGPr1ZWAWYmdAAJQwovzESw481.JPG\"/>-->\n            <img style=\"border: #999999 0.1px solid;padding:10px;width: 70%;height: auto\" src=\"http://192.168.199.100:8888/group1/M00/00/01/wKjHZGPr1ZWAD6_8AAb5j6JZa2E410.PNG\"/>\n    <!--        <img style=\"width: 100%;height: auto\" src=\"http://192.168.199.100:8888/group1/M00/00/01/wKjHZGPr1ZWAD6_8AAb5j6JZa2E410.PNG\"/>-->\n    <!--        <img style=\"width: 100%;height: auto\" src=\"http://192.168.199.100:8888/group1/M00/00/01/wKjHZGPr1ZWAD6_8AAb5j6JZa2E410.PNG\"/>-->\n    <!--        <img style=\"width: 100%;height: auto\" src=\"http://192.168.199.100:8888/group1/M00/00/01/wKjHZGPr1ZWAD6_8AAb5j6JZa2E410.PNG\"/>-->\n    <!--        <img style=\"width: 100%;height: auto\" src=\"http://192.168.199.100:8888/group1/M00/00/01/wKjHZGPr1ZWAD6_8AAb5j6JZa2E410.PNG\"/>-->\n    <!--        <img style=\"width: 100%;height: auto\" src=\"http://192.168.199.100:8888/group1/M00/00/01/wKjHZGPr1ZWAD6_8AAb5j6JZa2E410.PNG\"/>-->\n          <div style=\"width: 25%;padding:10px 0\">\n            <div style=\"width: 100%;margin-left: 5px\">\n                <div style=\"width: 100%;border-bottom: #999999 0.1px solid;padding-bottom: 3px\">\n                  <h1>123.png</h1>\n                </div>\n                <div style=\"width: 100%;border-bottom: #999999 0.1px solid;padding-bottom: 3px\">\n                <h4>创建时间</h4>\n                <span>2022-02-04</span>\n              </div>\n              <div style=\"width: 100%;border-bottom: #999999 0.1px solid;padding-bottom: 3px\">\n                <h4>简介</h4>\n                <span>21312341232112312312312312312</span>\n              </div>\n            </div>\n\n            <el-button-group style=\"margin: 30px 7% 0 8%\">\n              <el-button type=\"primary\" style=\"border-radius: 20px 0 0 20px;\" size=\"small\" icon=\"el-icon-arrow-left\">上一页</el-button>\n<!--              <el-button type=\"primary\" size=\"small\" icon=\"el-icon-connection\"></el-button>-->\n              <el-button type=\"primary\" style=\"border-radius: 0 20px 20px 0;\" size=\"small\">下一页<i class=\"el-icon-arrow-right el-icon--right\"></i></el-button>\n            </el-button-group>\n          </div>\n        </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"show.dialogFormVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"show.dialogFormVisible = false\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport FilesManagement from \"@/components/FilesManagement.vue\";\nexport default {\n  name: \"NewDiaryView\",\n  props:{\n    diary_id: String\n  },\n  components:{\n    FilesManagement\n  },\n  data() {\n    return {\n      articleForm: {\n        id: 0,\n        manager_id: 0,\n        title: '',\n        create_date: new Date(),\n        article: '',\n        info: '',\n        color: '',\n        weather: '',\n        score: 0,\n        collection: 0,\n        shit: 0\n      },\n      fileForm:{\n        id: 0,\n        url: '',\n        name:'',\n        rname:'',\n        info:'',\n        user_id:0,\n        diary_id:0,\n        create_date: null\n      },\n      icons:{\n        collection: 'el-icon-star-off',\n        date: 'el-icon-date',\n        shit: 'el-icon-help',\n        weather: 'el-icon-cloudy-and-sunny'\n      },\n      istyle:{\n        collection: 'margin-left: 10px;width:50px;height:50px',\n        date: 'margin-left:0px',\n        shit: '',\n        weather: '',\n        colors:{\n          oragne: 'background-color: coral',\n          green: 'background-color: greenyellow',\n          purple: 'background-color: violet',\n          gray: 'background-color: gray',\n          yellow: 'background-color: yellow',\n          pure: 'background-color: #fff'\n        }\n      },\n      show:{\n        show_pic_div: false,\n        dialogViewImg: true,\n        dialogFormVisible: false\n      },\n      value1: null,\n      value2: null,\n      value3: new Date(),\n      show_date: false,\n      show_weather: false,\n      drawer: true,\n      article: '',\n      images: []\n    }\n  },\n  mounted() {\n    // this.mounted_edit_diary();\n  },\n  methods:{\n    click_view___img(){\n      this.show.dialogViewImg = !this.show.dialogViewImg;\n    },\n    click_delete_img(id){\n      this.deleteRequest('/file/delete/'+id);\n      this.getRequest('/file/list4article/'+this.articleForm.id).then(resp=>{\n        this.images = resp ;\n      })\n    },\n    click_show_images(){\n      this.show.show_pic_div = !this.show.show_pic_div;\n      this.getRequest('/file/list4article/'+this.articleForm.id).then(resp=>{\n        this.images = resp ;\n      })\n    },\n    beforeUploadHandle(){\n      // alert(\"xxx\")\n    },\n    handleUploadForm(param){\n      // -- 跳出选择框\n      if(this.articleForm.id == 0){\n        this.$confirm('检测到该日记还没有保存，该操作必须要至少保存一次日记后才可以使用，是否保存？', '提示', {\n          confirmButtonText: '是，立即保存',\n          cancelButtonText: '否，稍后手动保存',\n          type: 'warning'\n        }).then(() => {\n          // -- 如果选择是，那么就进行提交，并且依据status进行判断，将返回值赋给 articleForm，以获得id\n          if(this.articleForm.title=='' || this.articleForm.article == ''){\n            this.$message.error('字段不完整，请填写标题与文章后再提交')\n            return;\n          }\n          this.postRequest('/diary/insert',this.articleForm).then(resp=>{\n            if(resp){\n              if(resp.code == 200) {\n                // -- 提交文章\n                this.articleForm = resp.obj;\n                // -- 上传图片\n                let formData = new FormData()\n                formData.append('file', param.file)\n                formData.append('diary_id', this.articleForm.id)\n                // 向后端发送数据\n                this.postRequest('/file/upload', formData).then((res) => {\n                  if (res.code === 200) {\n                    this.$message.success('修改信息成功')\n                  } else {\n                    this.$message.error('修改信息失败')\n                  }\n                  this.formFileList = []\n                  this.uploadFormFileList = []\n                })\n              }\n            }\n          })\n          return\n        // -- 如果选择否，则什么都不做\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消提交'\n          });\n          return\n        });\n      }else{\n        let formData = new FormData()\n        formData.append('file', param.file)\n        formData.append('diary_id', this.articleForm.id)\n        this.postRequest('/file/upload', formData).then((res) => {\n          if (res.code === 200) {\n            this.$message.success('提交成功')\n          } else {\n            this.$message.error('提交失败')\n          }\n          this.formFileList = []\n          this.uploadFormFileList = []\n        })\n      }\n    },\n    click_out_without_save(){\n      this.$confirm('检测到未保存的内容，是否在离开页面前保存修改？', '确认信息', {\n        distinguishCancelAndClose: true,\n        confirmButtonText: '保存',\n        cancelButtonText: '放弃修改'\n      })\n          .then(() => {\n            this.$message({\n              type: 'info',\n              message: '保存修改'\n            });\n            this.$store.commit('show_editor_page_false');\n          })\n\n          .catch(action => {\n            this.$message({\n              type: 'info',\n              message: action === 'cancel'\n                  ? '放弃保存并离开页面'\n                  : '停留在当前页面'\n            })\n            this.$store.commit('show_editor_page_false');\n          });\n\n    },\n    click_show_pic_button(){\n      this.show.show_pic_div = !this.show.show_pic_div;\n    },\n    mounted_edit_diary(){\n      if(this.diary_id != ''){\n        this.getRequest('/diary/article/'+this.$route.query.did).then(resp=>{\n          if (resp){\n            // alert(JSON.stringify(resp.data.obj));\n            this.articleForm = resp.data.obj;\n          }\n        })\n      }\n    },\n    // 点击了日期按钮\n    click_show_date(){\n      if(this.show_date ==true){\n        this.show_date = false;\n        this.icons.date = 'el-icon-date';\n        this.istyle.date = 'margin-left:0px';\n      }else{\n        this.icons.date = 'el-icon-loading';\n        this.istyle.date = 'margin-left:0px;background-color:#cfe6ff;border:#409EFF 1px solid;color:#ff7f50'\n        this.show_date = true;\n      }\n    },\n    // 点击了天气按钮\n    click_show_weather(){\n      if(this.show_weather == true){\n        this.show_weather = false;\n        this.icons.weather = 'el-icon-cloudy-and-sunny';\n        this.istyle.weather = '';\n      }else{\n        this.show_weather = true;\n        this.icons.weather = 'el-icon-sunny';\n        this.istyle.weather = 'background-color:#cfe6ff;border:#409EFF 1px solid;color:#ff7f50';\n      }\n    },\n    // 点击了收藏按钮\n    click_collect(){\n      this.articleForm.shit = 0;\n      this.istyle.shit = '';\n      if(this.articleForm.collection == 1){\n        this.articleForm.collection = 0;\n        this.icons.collection = 'el-icon-star-off';\n        this.istyle.collection = '';\n      }else{\n        this.articleForm.collection = 1;\n        this.icons.collection = 'el-icon-star-on';\n        this.istyle.collection = 'background-color:#cfe6ff;border:#409EFF 1px solid;color:#ff7f50';\n      }\n    },\n    click_shit(){\n      this.articleForm.collection = 0;\n      this.istyle.collection = '';\n      this.icons.collection = 'el-icon-star-off';\n      if(this.articleForm.shit == 1){\n        this.articleForm.shit = 0;\n        this.istyle.shit = '';\n      }else{\n        this.articleForm.shit = 1;\n        this.istyle.shit = 'background-color:#cfe6ff;border:#409EFF 1px solid;color:#ff7f50';\n      }\n    },\n    // 功能按钮\n    goBack(){\n      this.$router.push('/');\n    },\n    click_submit(){\n      this.postRequest('/diary/insert',this.articleForm).then(resp=>{\n        alert(JSON.stringify(resp.obj));\n        if(resp){\n          if(resp.code == 200) {\n            this.articleForm = resp.obj;\n          }\n        }\n      })\n    },\n    color_orange(){\n      this.init_color();\n      this.istyle.colors.oragne='background-color: coral; box-shadow: 0 0 8px red;';\n      this.articleForm.color='coral';\n    },\n    color_green(){\n      this.init_color();\n      this.istyle.colors.green='background-color: greenyellow;box-shadow: 0 0 8px green;';\n      this.articleForm.color='greenyellow';\n    },\n    color_purple(){\n      this.init_color();\n      this.istyle.colors.purple='background-color: violet;box-shadow: 0 0 8px purple;';\n      this.articleForm.color='violet';\n    },\n    color_gray(){\n      this.init_color();\n      this.istyle.colors.gray='background-color: gray;   box-shadow: 0 0 8px gray;';\n      this.articleForm.color='gray';\n    },\n    color_yellow(){\n      this.init_color();\n      this.istyle.colors.yellow='background-color: yellow;box-shadow: 0 0 8px gray;';\n      this.articleForm.color='yellow';\n    },\n    color_pure(){\n      this.init_color();\n      this.articleForm.color='';\n    },\n    init_color(){\n      this.istyle.colors.oragne='background-color: coral';\n      this.istyle.colors.green='background-color: greenyellow';\n      this.istyle.colors.purple='background-color: violet';\n      this.istyle.colors.gray='background-color: gray';\n      this.istyle.colors.yellow='background-color: yellow';\n      this.istyle.colors.pure='background-color: #fff';\n    },\n    click_weather(weather){\n      this.articleForm.weather = weather;\n    }\n  }\n}\n</script>\n\n<style scoped>\n.div_1{\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  /*background-color: blanchedalmond;*/\n}\n.header_1{\n  margin-top: 20px;\n}\n.input_title{\n  width: 100%;\n  border: lightslategray 1px solid;\n  border-radius: 5px;\n}\n.aside_1{\n  width: 250px;\n  padding: 30px;\n  /*background-color: coral;*/\n}\n.el-divider--vertical{\n  display: inline-block;\n  width: 1px;\n  height: 800px;\n  margin: 0 8px;\n  vertical-align: middle;\n  position: relative;\n}\n.button_color{\n  border-radius: 50%;\n  width: 15px;\n  height: 15px;\n  padding: 5px;\n  /*border: black .1px solid;*/\n}\n.button-submit{\n  width: 100%;\n}\n.button-submit-nosave{\n  width: 50%;\n}\n.button-submit-save{\n  width: 50%;\n}\n\n.el-date /deep/  .el-calendar-table .el-calendar-day{\n  width: 60px;\n  height: 40px;\n}\n.el_drawer_pics{\n}\n.div_weather{\n  margin-top: 15px;\n  background-color: #c3dad9;\n  padding: 10px 10px 10px 13px;\n  border-radius: 10px;\n}\n.button_weather{\n  border-radius: 50%;\n  width: 27px;\n  height: 27px;\n  padding: 5px;\n}\n.button_4 {\n  margin-left: 10px;\n  width: 50px;\n  height: 50px;\n  font-size: 18px;\n  border-radius: 15px;\n}\n.el-divider--horizontal {\n  display: block;\n  height: 1px;\n  width: 70%;\n  margin: 24px 14%;\n  /*background-color: orange;*/\n  /*box-shadow: 0 0 5px orange;*/\n}\n.new-diary-div-pics{\n  overflow:auto;\n  text-overflow:ellipsis;\n  width: 30%;\n  height: 90%;\n\n  border: #333333 1px solid;\n  border-radius: 5px;\n  margin-left: 10px;\n  /*margin-right: 10px;*/\n}\n.drawer-s-images{\n\n}\n\n.div-img-button-edit{\n  text-align: right;\n}\n\n.button-img-edit{\n  font-size: 15px;\n}\n</style>\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}