{"ast":null,"code":"import axios from 'axios';\nconst service = axios.create({\n  responseType: 'arraybuffer'\n});\nservice.interceptors.request.use(config => {\n  config.headers['Authorization'] = window.sessionStorage.getItem('tokenStr');\n  return config;\n}, error => {\n  console.log(error);\n});\nservice.interceptors.response.use(resp => {\n  const headers = resp.headers;\n  let reg = RegExp(/application\\/json/);\n  if (headers['content-type'].match(reg)) {\n    resp.data = uintToString(resp.data);\n  } else {\n    let fileDownload = require('js-file-download');\n    let fileName = headers[\"content-disposition\"].split(\";\")[1].split(\"filename=\")[1];\n    let contentType = headers[\"content-type\"];\n    fileName = decodeURIComponent(fileName);\n    fileDownload(resp.data, fileName, contentType);\n  }\n}, error => {\n  console.log(error);\n});\nlet base = '';\nexport const downloadRequest = (url, params) => {\n  return service({\n    method: 'get',\n    url: `${base}${url}`,\n    data: params\n  });\n};\nfunction uintToString(uintArray) {\n  let encodedString = String.fromCharCode.apply(null, new Uint8Array(uintArray)),\n    decodedString = decodeURIComponent(escape(encodedString));\n  return JSON.parse(decodedString);\n}\nexport default service;","map":{"version":3,"names":["axios","service","create","responseType","interceptors","request","use","config","headers","window","sessionStorage","getItem","error","console","log","response","resp","reg","RegExp","match","data","uintToString","fileDownload","require","fileName","split","contentType","decodeURIComponent","base","downloadRequest","url","params","method","uintArray","encodedString","String","fromCharCode","apply","Uint8Array","decodedString","escape","JSON","parse"],"sources":["/Users/hsk/Project/Diary/web/src/utils/download.js"],"sourcesContent":["import axios from 'axios'\n\nconst service = axios.create({\n    responseType: 'arraybuffer'\n})\nservice.interceptors.request.use(config => {\n    config.headers['Authorization'] = window.sessionStorage.getItem('tokenStr');\n    return config\n}, error => {\n    console.log(error)\n});\n\nservice.interceptors.response.use(\n    resp => {\n        const headers = resp.headers;\n        let reg = RegExp(/application\\/json/);\n        if (headers['content-type'].match(reg)) {\n            resp.data = uintToString(resp.data);\n        } else {\n            let fileDownload = require('js-file-download');\n            let fileName = headers[\"content-disposition\"].split(\";\")\n                [1].split(\"filename=\")[1];\n            let contentType = headers[\"content-type\"];\n            fileName = decodeURIComponent(fileName);\n            fileDownload(resp.data, fileName, contentType)\n        }\n    },error => {\n        console.log(error);\n    }\n);\nlet base = '';\nexport const downloadRequest = (url, params) => {\n    return service({\n        method: 'get',\n        url: `${base}${url}`,\n        data: params\n    })\n}\nfunction uintToString(uintArray) {\n    let encodedString = String.fromCharCode.apply(null, new\n        Uint8Array(uintArray)),\n        decodedString = decodeURIComponent(escape(encodedString));\n    return JSON.parse(decodedString);\n}\nexport default service\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,OAAO,GAAGD,KAAK,CAACE,MAAM,CAAC;EACzBC,YAAY,EAAE;AAClB,CAAC,CAAC;AACFF,OAAO,CAACG,YAAY,CAACC,OAAO,CAACC,GAAG,CAACC,MAAM,IAAI;EACvCA,MAAM,CAACC,OAAO,CAAC,eAAe,CAAC,GAAGC,MAAM,CAACC,cAAc,CAACC,OAAO,CAAC,UAAU,CAAC;EAC3E,OAAOJ,MAAM;AACjB,CAAC,EAAEK,KAAK,IAAI;EACRC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;AACtB,CAAC,CAAC;AAEFX,OAAO,CAACG,YAAY,CAACW,QAAQ,CAACT,GAAG,CAC7BU,IAAI,IAAI;EACJ,MAAMR,OAAO,GAAGQ,IAAI,CAACR,OAAO;EAC5B,IAAIS,GAAG,GAAGC,MAAM,CAAC,mBAAmB,CAAC;EACrC,IAAIV,OAAO,CAAC,cAAc,CAAC,CAACW,KAAK,CAACF,GAAG,CAAC,EAAE;IACpCD,IAAI,CAACI,IAAI,GAAGC,YAAY,CAACL,IAAI,CAACI,IAAI,CAAC;EACvC,CAAC,MAAM;IACH,IAAIE,YAAY,GAAGC,OAAO,CAAC,kBAAkB,CAAC;IAC9C,IAAIC,QAAQ,GAAGhB,OAAO,CAAC,qBAAqB,CAAC,CAACiB,KAAK,CAAC,GAAG,CAAC,CACnD,CAAC,CAAC,CAACA,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;IAC7B,IAAIC,WAAW,GAAGlB,OAAO,CAAC,cAAc,CAAC;IACzCgB,QAAQ,GAAGG,kBAAkB,CAACH,QAAQ,CAAC;IACvCF,YAAY,CAACN,IAAI,CAACI,IAAI,EAAEI,QAAQ,EAAEE,WAAW,CAAC;EAClD;AACJ,CAAC,EAACd,KAAK,IAAI;EACPC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;AACtB,CAAC,CACJ;AACD,IAAIgB,IAAI,GAAG,EAAE;AACb,OAAO,MAAMC,eAAe,GAAG,CAACC,GAAG,EAAEC,MAAM,KAAK;EAC5C,OAAO9B,OAAO,CAAC;IACX+B,MAAM,EAAE,KAAK;IACbF,GAAG,EAAG,GAAEF,IAAK,GAAEE,GAAI,EAAC;IACpBV,IAAI,EAAEW;EACV,CAAC,CAAC;AACN,CAAC;AACD,SAASV,YAAY,CAACY,SAAS,EAAE;EAC7B,IAAIC,aAAa,GAAGC,MAAM,CAACC,YAAY,CAACC,KAAK,CAAC,IAAI,EAAE,IAChDC,UAAU,CAACL,SAAS,CAAC,CAAC;IACtBM,aAAa,GAAGZ,kBAAkB,CAACa,MAAM,CAACN,aAAa,CAAC,CAAC;EAC7D,OAAOO,IAAI,CAACC,KAAK,CAACH,aAAa,CAAC;AACpC;AACA,eAAetC,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}